<!DOCTYPE html >
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>FreiDi-topicMapViz</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    
    <link media="screen" rel="sylesheet" href="topicMapVizGraph.css"></link>

    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css" media="screen"></link>
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap-theme.min.css" media="screen"></link>
    
    <script type="text/javascript" src="src/topicMapViz.js"></script>
    <script type="text/javascript" src="dist/bower.js" charset="utf-8"></script>
    <style type="text/css">
/*d3 graph*/
.link {
  fill: none;
  stroke: #666;
  stroke-width: 1.5px;
}

.node circle {
  fill: #ccc;
  stroke: #fff;
  stroke-width: 1.5px;
}

text {
  font: 10px sans-serif;
  pointer-events: none;
}
      /* topicDetail*/
      
      #meta .key{
        font-size: 1.2em;
        font-weight:bold;
      }
    </style>
  </head>
  <body>
    <div class="navbar navbar-default" role="navigation">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"/>
          <span class="icon-bar"/>
          <span class="icon-bar"/>
        </button>
        <a data-template="config:app-title" class="navbar-brand" href="./index.html">FreiDi-topicMapViz</a>
      </div>
      <div class="navbar-collapse collapse" id="navbar-collapse-1">
        <ul class="nav navbar-nav">
          <li>
            <a href="about.html">About</a>
          </li>
          <li>
            <a href="https://github.com/Freischuetz-Digital/topicMapViz" target="_blank">GitHub Repository</a>
          </li>
          <li>
            <a href="http://www.freischuetz-digital.de/index.html" target="_blank">Project Website</a>
          </li>
          
        </ul>
      </div>
    </div>
      
    <div id="content" class="container-fluid">
      <div class="row">
        <div class="col-md-2">
          <ul id="topicList"/>
        </div>
        <div class="col-md-10">
          <div class="row">
            <div class="span12" id="graph"></div>
          </div>
          <div class="row">
            <div class="span12" id="meta"></div>
          </div>
        </div>
      </div>
    </div>
      
    <script type="text/javascript">
      
      function getTopicDetails(topic, i){
        
        var newTopic = d3.select('#meta')
          .append('dl').classed('topicDetail', true);
          //topic
          newTopic.append('dt').classed('key', true)
          .text('Topic');
          newTopic.append('dd').classed('value', true)
          .text(topic.baseName.baseNameString);
          
          //variant(s)
          if(topic.baseName.variant){
            newTopic.append('dt').classed('key', true)
              .text('Alternative Schreibweisen');
            for(i=0; i < topic.baseName.variant.variantName.length; i++){
              newTopic.append('dd').classed('value', true)
                .text(topic.baseName.variant.variantName[i]);
            }
          };
          
          //declaration
          if(topic.declaration){
            newTopic.append('dt').classed('key', true)
              .text('Definition');
            newTopic.append('dd').classed('value', true)
              .text(topic.declaration.bibl);
          };
          
          //instanceOf
          newTopic.append('dt').classed('key', true)
            .text('Klassifizierung');
          for(i=0; i < topic.instanceOf.length; i++){
            newTopic.append('dd').classed('value', true)
              .text(topic.instanceOf[i].topicRef.href);
          };
          
          //occurrence(s)
          newTopic.append('dt').classed('key', true)
            .text('Nachweise');
          for(i=0; i < topic.occurrence.resourceRef.length; i++){
            newTopic.append('dd').classed('value', true)
              .text(topic.occurrence.resourceRef[i].href);
          }
          
      };
      
      function clearTopicDetail(){
        $('#meta').empty();
      };
      
      function renderGraph(topic, depth){};
      
      function selectTopic(i){
        
        var currentTopic = json.topic[i];
        console.log(currentTopic);
        var graphDepth = 2;
        
        $('.topicName').toggleClass('bg-primary',false);
        $('#topic_'+i).toggleClass('bg-primary', true); //append class selected
        
        clearTopicDetail();
        renderGraph(currentTopic, graphDepth);
        getTopicDetails(currentTopic, i);
        
      };
      
      var json;
      var topics;
      var associations;
      $.getJSON("data/FreiDi_topicMap.JSON", function(data){
        json = data;
        //console.log(json);
        topics = data.topic;
        //console.log(topics);
        associations = data.association;
        //console.log(associations);
        
        console.log(json.topic.length);
        
        for (i=0; i < json.topic.length; i++) {
          
            if(json.topic[i].baseName && json.topic[i].instanceOf) {
              $('#topicList').append('<li id="topic_'+i+'" class="topicName"><a href="#" onclick="selectTopic('+i+')">'+ json.topic[i].baseName.baseNameString +"</a></li>");
            };
        
        };
        
      }, 'json');
     
    </script>
      
      <!--<script type="text/javascript" src="src/topicMapViz.js"/>-->
      
      <!--<script type="text/javascript">
        var json;
        var topics;
        var associations;
        $.getJSON("data/FreiDi_topicMap.JSON", function(data){
          json = data;
          //console.log(json);
          topics = data.topic;
          //console.log(topics);
          associations = data.association;
          //console.log(associations);
          
          console.log(json.topic.length);
          
          for (i=0; i < json.topic.length; i++) {
            
              if(json.topic[i].baseName && json.topic[i].instanceOf) {
                $('#topicList').append('<li id="topic_'+i+'"><a href="#" onclick="selectTopic('+i+')">'+ json.topic[i].baseName.baseNameString +"</a></li>");
              };
          
          };
          
        }, 'json');
      </script>-->
        
      <!--<script type="text/javascript">
        d3.xml('topicMaps/FreiDi_TopicMap.xml', 'application/xml', function(xml) {
          d3.select('#topicList').data(xml.documentElement.getElementsByTagName('topic'))
            .enter().append("li")
              .classed('topic', true)
              .text(function(d){return d.select('baseNameString').textContent;});
            });
      </script>-->
      
      <script type="text/javascript">
        //demo graphs
          var links5 = [{"source": "nacht", "target": "wolfsschluchtszene", "type": "part-of"},{"source": "mond", "target": "nacht", "type": "part-of"},{"source": "mond", "target": "wolfsschluchtszene", "type": "part-of"},{"source": "kugelguss", "target": "wolfsschluchtszene", "type": "part-of"},{"source": "wald", "target": "wolfsschluchtszene", "type": "part-of"},{"source": "kreuzweg", "target": "wolfsschluchtszene", "type": "part-of"},{"source": "max", "target": "wolfsschluchtszene", "type": "part-of"},{"source": "sammiel", "target": "wolfsschluchtszene", "type": "part-of"},{"source": "caspar", "target": "wolfsschluchtszene", "type": "part-of"},{"source": "form", "target": "kugelguss", "type": "used-for"},{"source": "kohlen", "target": "kugelguss", "type": "used-for"},{"source": "blei", "target": "kugelguss", "type": "used-for"},{"source": "max", "target": "jaeger", "type": "same-as"},{"source": "max", "target": "wilhelm", "type": "comparable-with"},{"source": "max", "target": "agathe", "type": "related-to"},{"source": "wilhelm", "target": "jaeger", "type": "same-as"},{"source": "wilhelm", "target": "pauline", "type": "related-to"}];
          var links6 = [{"source": "braeutigam", "target": "braut", "type": "#affectionate-to"},{"source": "agathe", "target": "braut", "type": "#is-a"},{"source": "braut", "target": "hochzeit", "type": "#undergo"},{"source": "pauline", "target": "braut", "type": "#same-as"},{"source": "kaethchen", "target": "braut", "type": "#same-as"},{"source": "elfride", "target": "braut", "type": "#same-as"},{"source": "juliane", "target": "braut", "type": "#same-as"},{"source": "schleier", "target": "braut", "type": "#belong-to"},{"source": "brautjungfern", "target": "braut", "type": "#friendly-related-to"},{"source": "braut", "target": "hochzeit", "type": "#undergo"},{"source": "kranz", "target": "braut", "type": "#belong-to"}];
          var links7 = [{"source": "braeutigam", "target": "braut", "type": "#affectionate-to"},{"source": "max", "target": "braeutigam", "type": "#is-a"},{"source": "braeutigam", "target": "braut", "type": "#affectionate-to"},{"source": "wilhelm", "target": "braeutigam", "type": "#is-a"},{"source": "edward", "target": "braeutigam", "type": "#is-a"},{"source": "benno", "target": "braeutigam", "type": "#same-as"},{"source": "agathe", "target": "braut", "type": "#is-a"},{"source": "max", "target": "agathe", "type": "#affectionate-to"},{"source": "agathe", "target": "braut", "type": "#is-a"},{"source": "agathe", "target": "tochter", "type": "#is-a"},{"source": "agathe", "target": "maedchen", "type": "#is-a"},{"source": "agathe", "target": "pauline", "type": "#comparable-with"},{"source": "agathe", "target": "kaethchen", "type": "#comparable-with"},{"source": "agathe", "target": "elfride", "type": "#comparable-with"},{"source": "agathe", "target": "leonore", "type": "#comparable-with"},{"source": "agathe", "target": "juliane", "type": "#comparable-with"},{"source": "agathe", "target": "bertha", "type": "#comparable-with"},{"source": "agathe", "target": "opfer", "type": "#same-as"},{"source": "agathe", "target": "taube", "type": "#same-as"},{"source": "agathe", "target": "grillen", "type": "#undergo"},{"source": "annchen", "target": "agathe", "type": "#friendly-related-to"},{"source": "kranz", "target": "agathe", "type": "#belong-to"},{"source": "agathe", "target": "traum", "type": "#undergo"},{"source": "eremit", "target": "agathe", "type": "#friendly-related-to"},{"source": "rosen", "target": "agathe", "type": "#belong-to"},{"source": "pauline", "target": "braut", "type": "#same-as"},{"source": "wilhelm", "target": "pauline", "type": "#affectionate-to"},{"source": "agathe", "target": "pauline", "type": "#comparable-with"},{"source": "pauline", "target": "braut", "type": "#same-as"},{"source": "pauline", "target": "tochter", "type": "#same-as"},{"source": "pauline", "target": "traum", "type": "#undergo"},{"source": "kaethchen", "target": "braut", "type": "#same-as"},{"source": "wilhelm", "target": "kaethchen", "type": "#affectionate-to"},{"source": "agathe", "target": "kaethchen", "type": "#comparable-with"},{"source": "kaethchen", "target": "braut", "type": "#same-as"},{"source": "elfride", "target": "braut", "type": "#same-as"},{"source": "agathe", "target": "elfride", "type": "#comparable-with"},{"source": "elfride", "target": "braut", "type": "#same-as"},{"source": "elfride", "target": "traum", "type": "#undergo"},{"source": "juliane", "target": "braut", "type": "#same-as"},{"source": "agathe", "target": "juliane", "type": "#comparable-with"},{"source": "juliane", "target": "braut", "type": "#same-as"},{"source": "juliane", "target": "traum", "type": "#undergo"},{"source": "schleier", "target": "braut", "type": "#belong-to"},{"source": "schleier", "target": "braut", "type": "#belong-to"},{"source": "brautjungfern", "target": "braut", "type": "#friendly-related-to"},{"source": "brautjungfern", "target": "braut", "type": "#friendly-related-to"},{"source": "kranz", "target": "brautjungfern", "type": "#belong-to"},{"source": "brautjungfern", "target": "reigen", "type": "#undergo"},{"source": "braut", "target": "hochzeit", "type": "#undergo"},{"source": "braut", "target": "hochzeit", "type": "#undergo"},{"source": "reigen", "target": "hochzeit", "type": "#part-of"},{"source": "kranz", "target": "braut", "type": "#belong-to"},{"source": "kranz", "target": "braut", "type": "#belong-to"},{"source": "myrte", "target": "kranz", "type": "#part-of"},{"source": "lavendel", "target": "kranz", "type": "#part-of"},{"source": "seide", "target": "kranz", "type": "#part-of"},{"source": "rosmarin", "target": "kranz", "type": "#part-of"},{"source": "thymian", "target": "kranz", "type": "#part-of"},{"source": "silber", "target": "kranz", "type": "#part-of"},{"source": "kranz", "target": "winden", "type": "#used-for"},{"source": "kranz", "target": "brautjungfern", "type": "#belong-to"},{"source": "kranz", "target": "agathe", "type": "#belong-to"}];
        </script>
      <script type="text/javascript">
        
      

      var links = links7;
          
          var nodes = {};

         // Compute the distinct nodes from the links.
         links.forEach(function(link) {//refer data
           link.source = nodes[link.source] || (nodes[link.source] = {name: link.source});
           link.target = nodes[link.target] || (nodes[link.target] = {name: link.target});
         });
         
        // console.log(links);

         var width = 600,
             height = 300;
         
         var force = d3.layout.force()
             .nodes(d3.values(nodes))
             .links(links) //refer data
             .size([width, height])
             .linkDistance(60)
             .charge(-300)
             .on("tick", tick)
             .start();
         
         var svg = d3.select("#graph").append("svg")
             .attr("width", width)
             .attr("height", height);
         
         var link = svg.selectAll(".link")
             .data(force.links())
             .enter().append("line")
               .attr("class", "link")
               .attr("title",function(d) { return d.type; });
         
         var node = svg.selectAll(".node")
             .data(force.nodes())
            .enter().append("g")
              .attr("class", "node")
              .on("mouseover", mouseover)
              .on("mouseout", mouseout)
              .call(force.drag);
         
         node.append("circle")
             .attr("r", 8);
         
         node.append("text")
             .attr("x", 12)
             .attr("dy", ".35em")
             .text(function(d) { return d.name; });
         
         function tick() {
           link
               .attr("x1", function(d) { return d.source.x; })
               .attr("y1", function(d) { return d.source.y; })
               .attr("x2", function(d) { return d.target.x; })
               .attr("y2", function(d) { return d.target.y; });
         
           node
               .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
         }
         
         function mouseover() {
           d3.select(this).select("circle").transition()
               .duration(750)
               .attr("r", 16);
         }
         
         function mouseout() {
           d3.select(this).select("circle").transition()
               .duration(750)
               .attr("r", 8);
         }
        
      </script>
      <script type="text/javascript" src="bower_components/bootstrap/dist/js/bootstrap.min.js"/>
      
    </body>
</html>